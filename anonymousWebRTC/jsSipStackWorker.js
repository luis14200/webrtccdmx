importScripts("jsSipStack.js"),addOnInit((function(){postMessage({cmd:"jsSipStackInit",code:!0})}));var running=!0,loglevel=2;function process(){running?(_jsSipProcess(),setTimeout(process,200)):_jsSipClear()}var log={};self.sipPrint=function(e,l){if(e>=loglevel)switch(e){case 0:this.log.debug(l);break;case 1:this.log.log(l);break;case 2:this.log.info(l);break;case 3:this.log.warn(l);break;case 4:case 5:this.log.error(l)}},this.onmessage=function(e){var l=e.data;switch(l.cmd){case"workerParam":self.localStorage=l.localStorage,self.sessionStorage=l.sessionStorage,self.sessionStorage.closedLastTab="1",importScripts("debug.js"),log.debug=debug("SIPSTACK:DEBUG"),log.log=debug("SIPSTACK:LOG"),log.info=debug("SIPSTACK:INFO"),log.warn=debug("SIPSTACK:WARN"),log.error=debug("SIPSTACK:ERROR");break;case"addHeaderList":var n=allocateUTF8(l.headerName),a=allocateUTF8(l.headerValue);_addHeaderList(n,a,l.isModify,l.modifyPos),_free(n),_free(a);break;case"jsSipInit":null!==l.level&&(loglevel=l.level),_jsSipInit(loglevel);break;case"jsSipStart":var s=allocateUTF8(JSON.stringify(l.config));console.log("SIPStack start."),_jsSetSip(s),_free(s),running=!0,process();break;case"jsSipStop":console.log("SIPStack stop."),running=!1;break;case"jsSipSendRegister":if(null!==l.contentType&&null!==l.body){var t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendRegister(l.expires,t,o),_free(contentType),_free(o)}else _jsSipSendRegister(l.expires);break;case"jsSipSendUnRegister":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendUnRegister(t,o),_free(t),_free(o)}else _jsSipSendUnRegister();break;case"jsSipSendMessage":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendMessage(l.line,t,o),_free(t),_free(o)}else _jsSipSendMessage(l.line);break;case"jsSipSendOptions":var i=allocateUTF8(l.toUri);if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendOptions(i,l.line,t,o),_free(t),_free(o)}else _jsSipSendOptions(i,l.line);_free(i);break;case"jsSipSendSubscribe":i=allocateUTF8(l.toUri);var c=allocateUTF8(l.event);if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);if(null!==l.accept){var r=allocateUTF8(l.accept);_jsSipSendSubscribe(i,c,l.id,l.expires,r,t,o),_free(r)}else _jsSipSendSubscribe(i,c,l.id,l.expires,t,o);_free(t),_free(o)}else if(null!==l.accept){r=allocateUTF8(l.accept);_jsSipSendSubscribe(i,c,l.id,l.expires,r),_free(r)}else _jsSipSendSubscribe(i,c,l.id,l.expires);_free(c);break;case"jsSipSendInvite":i=allocateUTF8(l.toUri);if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendInvite(i,l.line,t,o),_free(t),_free(o)}else _jsSipSendInvite(i,l.line);_free(i);break;case"jsSipSendCancel":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendCancel(l.line,t,o),_free(t),_free(o)}else _jsSipSendCancel(l.line);break;case"jsSipSendReInvite":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendReInvite(l.line,t,o),_free(t),_free(o)}else _jsSipSendReInvite(l.line);break;case"jsSipSendInfo":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendInfo(l.line,t,o),_free(t),_free(o)}else _jsSipSendInfo(l.line);break;case"jsSipSendUpdate":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendUpdate(l.line,t,o),_free(t),_free(o)}else _jsSipSendUpdate(l.line);break;case"jsSipSendRefer":var S=allocateUTF8(l.referTo),p=allocateUTF8(l.referredBy);if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendRefer(S,p,l.line,t,o),_free(t),_free(o)}else _jsSipSendRefer(S,p,l.line);_free(S),_free(p);break;case"jsSipSendBye":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendBye(l.line,t,o),_free(t),_free(o)}else _jsSipSendBye(l.line);break;case"jsSipSendAck":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendAck(l.line,t,o),_free(t),_free(o)}else _jsSipSendAck(l.line);break;case"jsSipSendRsp":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipSendRsp(l.transaction,l.rspcode,t,o),_free(t),_free(o)}else _jsSipSendRsp(l.transaction,l.rspcode);break;case"jsSipAcceptCall":if(null!==l.contentType&&null!==l.body){t=allocateUTF8(l.contentType),o=allocateUTF8(l.body);_jsSipAcceptCall(l.transaction,l.line,l.rspcode,t,o),_free(t),_free(o)}else _jsSipAcceptCall(l.transaction,l.line);break;case"jsSipParser":var d=allocateUTF8(l.param);_jsSipParser(d),_free(d)}};